(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{759:function(s,e,a){"use strict";a.r(e);var t=a(60),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"sql-server分頁技巧-pagination"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql-server分頁技巧-pagination"}},[s._v("#")]),s._v(" SQL Server分頁技巧(Pagination)")]),s._v(" "),a("h6",{attrs:{id:"tags-工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tags-工作"}},[s._v("#")]),s._v(" tags: "),a("code",[s._v("工作")])]),s._v(" "),a("p",[s._v("參考連結：https://ithelp.ithome.com.tw/articles/10190424")]),s._v(" "),a("p",[a("strong",[s._v("使用語法")])]),s._v(" "),a("div",{staticClass:"language-sql= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT *\nFROM XXXTable\n--如果要使用分頁語法，一定要加上排序，不然會出錯。\nORDER BY ID \n--這一行語法是指「略過」前n行，列出從第k行開始的8筆資料。\nOFFSET n ROWS　\nFETCH NEXT k ROWS ONLY\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("取得分頁數")])]),s._v(" "),a("div",{staticClass:"language-sql= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select ceiling(count(1) / PageSize) TotalPages \n  from XXXTable\n-- ceiling 無條件進入\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("分頁語法")])]),s._v(" "),a("div",{staticClass:"language-sql= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from XXXTable\norder by id desc\nOFFSET $offset$ ROWS FETCH NEXT $pageSize$ ROWS ONLY\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("$offset$(略過筆數) = (PageSize * (CurrentPage - 1)\n$pageSize$(每頁數目)")])])}),[],!1,null,null,null);e.default=n.exports}}]);