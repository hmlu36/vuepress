(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{763:function(s,a,t){"use strict";t.r(a);var n=t(60),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"註解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#註解"}},[s._v("#")]),s._v(" 註解")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('# 單行註解可以使用\'#\'\n#多行註解使用 """\n"""\n\tThis is a comment\n\twritten in\n\tmore than just one line\n"""\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"beautifulsoup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#beautifulsoup"}},[s._v("#")]),s._v(" BeautifulSoup")]),s._v(" "),t("p",[s._v("bs4 使用 Python 標準函示庫中的 html.parser 來剖析 HTML；同時也支援第三方的 lxml 和 html5lib 套件作為剖析器，一般建議使用比較快的 lxml。使用前也需要先安裝套件。")]),s._v(" "),t("p",[s._v("sample")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("from bs4 import BeautifulSoup\nsoup = BeautifulSoup(html_doc, 'lxml')\n\nprint(type(soup))\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("bs4 提供很完整的遍歷方法，這邊介紹幾個常用的，完整版可以參考"),t("a",{attrs:{href:"https://www.crummy.com/software/BeautifulSoup/bs4/doc/#navigating-the-tree",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文件"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 取得 head 標籤\nsoup.head\n\n# 取得 head 下的 title 標籤\nsoup.head.title\n\n# 取得「第一個」a 標籤\nsoup.a\n\n# 取得直屬 body 的所有下層標籤\nsoup.body.contents\n\n# 取得第一個a 標籤的上層標籤\nsoup.a.parent\n\n# 取得與第一個 a 標籤同層級的下一個「元素」\nsoup.a.next_sibling\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h2",{attrs:{id:"搜尋-html-結構"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搜尋-html-結構"}},[s._v("#")]),s._v(" 搜尋 HTML 結構")]),s._v(" "),t("ul",[t("li",[s._v("字串：指定要搜尋的標籤名稱")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 搜尋標籤 \"b\"\nsoup.find_all('b')\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("正規表示式：利用 Python re 物件的 search() 方法來搜尋符合的標籤名稱")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('# 搜尋以 "b" 開頭的標籤\nimport re\nfor tag in soup.find_all(re.compile("^b")):\n    print(tag.name)\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[s._v("清單：指定多個要搜尋的標籤名稱")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('# 搜尋標籤 "a" 和 "b"\nsoup.find_all(["a", "b"])\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("*方法：定義一個會回傳布林的方法物件來判斷是否要傳回標籤")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('def has_class_but_no_id(tag):\n    """ 判斷標籤是否定義 class 屬性且無定義 id 屬性\n    """\n    return tag.has_attr(\'class\') and not tag.has_attr(\'id\')\n\nsoup.find_all(has_class_but_no_id)\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("find_all(name, attrs, recursive, string, limit, **kwargs)"),t("br"),s._v("\nname：帶入前面介紹的「過濾器」\nattrs：傳入 dict 物件，用屬性來過濾，待會跟 keyword arguments 一起介紹\nrecursive：使用布林值（預設是 True），用來設定是否要遞迴往下找")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('# 找 html 標籤下的所有標籤\nsoup.html.find_all("title")\n\n# 只找 html 的「下一層」標籤\n# 因為一般 html 下一層只有 head 和 body\n# 所以找不到結果\nsoup.html.find_all("title", recursive=False)\n\n# 找出 id 屬性值為 link2 的標籤\nsoup.find_all(id=\'link2\')\n\n# 用 re 找出 href 屬性值包含 elsie 的標籤\nsoup.find_all(href=re.compile("elsie"))\n\n# 找出有 id 屬性的標籤\nsoup.find_all(id=True)\n\n# 也可以同時使用多個屬性來判斷\nsoup.find_all(href=re.compile("elsie"), id=\'link1\')\n\n# 保留字 class\nsoup.find_all("a", class_="sister")\n\n# 屬性名稱與方法參數名稱相同\nsoup.find_all(attrs={"name": "email"})\n\n# kebab-case\ndata_soup = BeautifulSoup(\'<div data-foo="value">foo!</div>\')\ndata_soup.find_all(data-foo="value")\n\ndata_soup.find_all(attrs={"data-foo": "value"})\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h2",{attrs:{id:"css-選擇器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#css-選擇器"}},[s._v("#")]),s._v(" CSS 選擇器")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 找出 body 下的 a 標籤\nsoup.select('body a')\n\n# 找出 class 包含 sister 的標籤\nsoup.select('.sister')\n\n# 找出 id 是 link2 的標籤\nsoup.select('#link2')\n\n# 找出「第一個」class 包含 sister 的標籤\nsoup.select_one('.sister')\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"xpath-常用語法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xpath-常用語法"}},[s._v("#")]),s._v(" XPath 常用語法")]),s._v(" "),t("p",[t("em",[s._v("選擇節點（selecting nodes）")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("語法")]),s._v(" "),t("th",[s._v("說明")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("node-name")]),s._v(" "),t("td",[s._v("選擇名稱等於 node-name 的節點")])]),s._v(" "),t("tr",[t("td",[s._v("/")]),s._v(" "),t("td",[s._v("選擇直屬於當前節點的所有節點（子節點）")])]),s._v(" "),t("tr",[t("td",[s._v("//")]),s._v(" "),t("td",[s._v("選擇當前節點下所有節點（子孫節點）")])]),s._v(" "),t("tr",[t("td",[s._v(".")]),s._v(" "),t("td",[s._v("選擇當前節點")])]),s._v(" "),t("tr",[t("td",[s._v("..")]),s._v(" "),t("td",[s._v("選擇上一層節點（父節點）")])]),s._v(" "),t("tr",[t("td",[s._v("@")]),s._v(" "),t("td",[s._v("選擇屬性")])])])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("查詢路徑")]),s._v(" "),t("th",[s._v("結果")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("/html")]),s._v(" "),t("td",[s._v("取得 html 標籤（以 / 開頭代表從根節點開始找）")])]),s._v(" "),t("tr",[t("td",[s._v("/html/body/a")]),s._v(" "),t("td",[s._v("取得 body 下所有 a 標籤（無結果，因為 a 在 p 底下）")])]),s._v(" "),t("tr",[t("td",[s._v("//a")]),s._v(" "),t("td",[s._v("取得所有 a 標籤")])]),s._v(" "),t("tr",[t("td",[s._v("/html/body//a")]),s._v(" "),t("td",[s._v("取得 body 下所有 a 標籤")])]),s._v(" "),t("tr",[t("td",[s._v("//a/@href")]),s._v(" "),t("td",[s._v("取得所有 a 標籤的 href 屬性")])])])]),s._v(" "),t("p",[s._v("用 lxml 的 etree.HTML() 方法載入 HTML 原始資料後，可以用 .xpath() 方法來執行 XPath 查詢：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("from lxml import etree\n\n# 載入 HTML 原始資料\nhtml = etree.HTML(html_doc)\n\nprint(html.xpath('/html'))\nprint(html.xpath('/html/body/a'))\nprint(html.xpath('//a'))\nprint(html.xpath('/html/body//a'))\nprint(html.xpath('//a/@href'))\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h2",{attrs:{id:"判斷式-predicates"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#判斷式-predicates"}},[s._v("#")]),s._v(" 判斷式（predicates）")]),s._v(" "),t("p",[s._v("用 [ 和 ] 包起來，用來對查詢加上一些額外的限制")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("判斷式")]),s._v(" "),t("th",[s._v("結果")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("/html/body//a[1]")]),s._v(" "),t("td",[s._v("取得 body 下第一個 a 標籤")])]),s._v(" "),t("tr",[t("td",[s._v("/html/body//a[last() - 1]")]),s._v(" "),t("td",[s._v("取得 body 下最後一個 a 標籤")])]),s._v(" "),t("tr",[t("td",[s._v("/html/body//a[position() < 3]")]),s._v(" "),t("td",[s._v("取得 body 下前兩個 a 標籤")])]),s._v(" "),t("tr",[t("td",[s._v("//p[@class]")]),s._v(" "),t("td",[s._v("取得有定義 class 屬性的 p 標籤")])]),s._v(" "),t("tr",[t("td",[s._v("//p[@class='title']")]),s._v(" "),t("td",[s._v("取得 class 屬性值為 title 的 p 標籤")])])])]),s._v(" "),t("p",[s._v("選取任意節點")]),s._v(" "),t("p",[s._v("XPath 也支援萬用字元（wildcards）來選取任意節點\n|萬用字元 \t| 說明\t   |\n|* \t\t\t| 任意標籤 |\n|@* \t\t| 任意屬性 |")]),s._v(" "),t("p",[s._v("以我們使用的 HTML 原始內容來說：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("查詢路徑")]),s._v(" "),t("th",[s._v("結果")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("/html/body/*")]),s._v(" "),t("td",[s._v("取得 body 標籤的全部子節點")])]),s._v(" "),t("tr",[t("td",[s._v("/html/body//*")]),s._v(" "),t("td",[s._v("取得 body 下全部標籤")])]),s._v(" "),t("tr",[t("td",[s._v("//p[@*]")]),s._v(" "),t("td",[s._v("取得至少有定義一個屬性的 p 標籤")])])])]),s._v(" "),t("p",[s._v("一次選取多個路徑\n如果想要一次查詢多組路徑，可以用 | 來達成。")]),s._v(" "),t("h2",{attrs:{id:"table操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#table操作"}},[s._v("#")]),s._v(" Table操作")]),s._v(" "),t("p",[s._v("取得第N筆以後tr的資料")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("table.find_all('tr')[N:]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("抓取前N筆的資料")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("row[:N]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);